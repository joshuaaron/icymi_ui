<div class="container">
  <div class="chart">
    <div class="chart__bar" id="bar-1"></div>
    <div class="chart__bar" id="bar-2"></div>
    <div class="chart__bar" id="bar-3"></div>
  </div>
  <div class="actions">
    <input data-bar-id="bar-1" type="range" min="0" max="100" value="90">
    <input data-bar-id="bar-2" type="range" min="0" max="100" value="25">
    <input data-bar-id="bar-3" type="range" min="0" max="100" value="75">
  </div>
  <div class="chart__tooltip chart__tooltip--max">ðŸ‘ˆ Max</div>
  <div class="chart__tooltip chart__tooltip--min">Min ðŸ‘‰</div>
  <div class="size-display">
    <div class="size-bar size-bar--max">
      <span class="size-label">max:</span>
      <span class="size-fill size-fill--max"></span>
    </div>
    <div class="size-bar size-bar--min">
      <span class="size-label">min:</span>
      <span class="size-fill size-fill--min"></span>
    </div>
  </div>
</div>
<style>
  .container {
    --accent-one: #80bdf6;
    --accent-two: #f68080;
    --accent-three: #b8d7b2;
    --accent-four: #b4b0ad;

    container-type: inline-size;
    anchor-scope: --anchor-one, --anchor-two, --anchor-three;
  }

  .chart__tooltip--max {
    position: absolute;
    left: anchor(--chart right);
    bottom: max(anchor(--anchor-one top), anchor(--anchor-two top), anchor(--anchor-three top));
    translate: 0 50%;
  }
  .chart__tooltip--min {
    position: absolute;
    right: calc(anchor(--chart left));
    bottom: min(anchor(--anchor-one top), anchor(--anchor-two top), anchor(--anchor-three top));
    translate: 0 50%;
  }

  .chart {
    anchor-name: --chart;
    width: 85cqi;
    aspect-ratio: 4 / 3;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    padding: 1rem;
    align-items: end;
    margin-inline: auto;
  }

  .actions {
    anchor-name: --actions;
    width: 85cqi;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-gap: 1rem;
    padding: 1rem;
    margin-inline: auto;
  }

  input {
    min-width: 0;
    &:nth-child(1) {
      inline-size: anchor-size(--anchor-one width);
    }
    &:nth-child(2) {
      inline-size: anchor-size(--anchor-two width);
    }
    &:nth-child(3) {
      inline-size: anchor-size(--anchor-three width);
    }
  }

  .chart__bar {
    background: var(--bg, var(--indigo-4));
    height: calc(var(--height, 100) * 1%);
    opacity: 0.75;
  }

  .chart__bar:nth-of-type(1) {
    anchor-name: --anchor-one;
    --bg: var(--accent-one);
    height: 90%;
  }

  .chart__bar:nth-of-type(2) {
    anchor-name: --anchor-two;
    --bg: var(--accent-two);
    height: 25%;
  }

  .chart__bar:nth-of-type(3) {
    anchor-name: --anchor-three;
    --bg: var(--anchor);
    height: 75%;
  }

  .chart__tooltip {
    padding: var(--size-4);
    background: var(--surface-1);
    box-shadow: var(--shadow-4);
    border-radius: var(--radius-2);
  }

  input[type="range"] {
    --thumb-size: 16px;
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 6px;
    background: var(--border-opaque);
    border-radius: 3px;
    cursor: pointer;

    /* Track - Firefox */
    &::-moz-range-track {
      background: var(--border-opaque);
      height: 6px;
      border-radius: 3px;
    }

    /* Thumb - WebKit */
    &::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: var(--thumb-size);
      height: var(--thumb-size);
      background: var(--form-control);
      border-radius: 50%;
      border: 1px solid var(--border-opaque);
      cursor: pointer;
      transition: all 0.15s;
    }

    &:active::-webkit-slider-thumb {
      border: var(--form-control);
    }

    /* Thumb - Firefox */
    &::-moz-range-thumb {
      width: var(--thumb-size);
      height: var(--thumb-size);
      background: var(--form-control);
      border-radius: 50%;
      border: 1px solid var(--border-opaque);
      cursor: pointer;
      transition: all 0.15s;
    }

    &:hover::-webkit-slider-thumb {
      transform: scale(1.1);
    }

    &:hover::-moz-range-thumb {
      transform: scale(1.1);
    }
  }

  .size-display {
    width: 85cqi;
    margin-inline: auto;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .size-bar {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .size-bar--max span:first-child {
    anchor-name: --label-max;
  }

  .size-bar--min span:first-child {
    anchor-name: --label-min;
  }

  .size-label {
    font-size: 0.875rem;
    font-weight: 600;
    width: 3rem;
    color: rgba(255, 255, 255, 0.7);
  }

  .size-fill {
    position: absolute;
    left: anchor(--actions left);
    height: 12px;
    border-radius: 4px;
    transition: inline-size 0.3s ease-out;
    translate: 0 50%;
  }
  .size-fill--max {
    position: absolute;
    position-anchor: --label-max;
    left: calc(anchor(right) + 0.5rem);
    top: anchor(top);
    bottom: anchor(bottom);
    border-radius: 4px;
    inline-size: max(
      anchor-size(--anchor-one height),
      anchor-size(--anchor-two height),
      anchor-size(--anchor-three height)
    );
    background: var(--accent-three);
    box-shadow: 0 0 8px var(--accent-three);
    transition: inline-size 0.3s ease-out;
  }

  .size-fill--min {
    position: absolute;
    position-anchor: --label-min;
    left: calc(anchor(right) + 0.5rem);
    top: anchor(top);
    bottom: anchor(bottom);
    border-radius: 4px;
    inline-size: min(
      anchor-size(--anchor-one height),
      anchor-size(--anchor-two height),
      anchor-size(--anchor-three height)
    );
    background: var(--accent-four);
    box-shadow: 0 0 8px var(--accent-four);
    transition: inline-size 0.3s ease-out;
  }
</style>

<script>
  const inputs = document.querySelectorAll("input");

  const update = (e) => {
    const barId = document.querySelector(
      `#${e.target.getAttribute("data-bar-id")}`,
    ) as HTMLInputElement;

    barId.style.height = `${e.target.value}%`;
  };

  inputs.forEach((input) => {
    input.addEventListener("input", update);
  });
</script>
